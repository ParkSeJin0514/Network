# ðŸ§ª Network Shell Script ì‹¤ìŠµ ë¬¸ì œ
## ðŸ’» ë¬¸ì œ í™˜ê²½ ì„¤ì •
- ì‹¤ìŠµì„ ìœ„í•´ ë‹¤ìŒ íŒŒì¼ë“¤ì„ ìƒì„±í•˜ì„¸ìš”
## ðŸ”¹ 1. ë„¤íŠ¸ì›Œí¬ ë¡œê·¸ íŒŒì¼ ìƒì„±
```bash
cat > network.log << 'EOF'
2024-01-15 10:30:25 192.168.1.100 CONNECT success
2024-01-15 10:30:30 192.168.1.101 CONNECT failed
2024-01-15 10:31:15 192.168.1.102 CONNECT success
2024-01-15 10:31:20 192.168.1.100 DISCONNECT success
2024-01-15 10:32:10 192.168.1.103 CONNECT success
2024-01-15 10:32:15 192.168.1.101 CONNECT success
2024-01-15 10:33:25 192.168.1.104 CONNECT failed
2024-01-15 10:33:30 192.168.1.102 DISCONNECT success
EOF
```

## ðŸ”¹ 3. ì ‘ì† í†µê³„ íŒŒì¼ ìƒì„±
```bash
cat > connections.txt << 'EOF'
192.168.1.100 5
192.168.1.101 12
192.168.1.102 8
192.168.1.103 3
192.168.1.104 15
192.168.1.105 7
EOF
```
## ðŸ“ ë¬¸ì œ 1. ë„¤íŠ¸ì›Œí¬ ì—°ê²° ìƒíƒœ ë¶„ì„ê¸°
### âœ… ìš”êµ¬ì‚¬í•­
- network.log íŒŒì¼ì„ ë¶„ì„í•˜ì—¬ ì—°ê²° ì„±ê³µ/ì‹¤íŒ¨ í†µê³„ë¥¼ ì¶œë ¥í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ ìž‘ì„±
- ì „ì²´ ì—°ê²° ì‹œë„ ìˆ˜, ì„±ê³µ ìˆ˜, ì‹¤íŒ¨ ìˆ˜ë¥¼ ê³„ì‚°
- ì„±ê³µë¥ ì„ ë°±ë¶„ìœ¨ë¡œ í‘œì‹œ (ì†Œìˆ˜ì  ì œê±°)
### ðŸŽ¯ ì¶œë ¥ í˜•íƒœ
```
=== ë„¤íŠ¸ì›Œí¬ ì—°ê²° ë¶„ì„ ê²°ê³¼ ===
ì „ì²´ ì—°ê²° ì‹œë„: Xê±´
ì„±ê³µ: Yê±´
ì‹¤íŒ¨: Zê±´
ì„±ê³µë¥ : W%
```
### âœ… ì œí•œì‚¬í•­
- ifë¬¸ê³¼ ë³€ìˆ˜ë§Œ ì‚¬ìš©
- grep, wc, cut ëª…ë ¹ì–´ í™œìš©
- íŒŒì¼ëª…ì€ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ì‹œ ì²« ë²ˆì§¸ ì¸ìžë¡œ ë°›ê¸°

### ðŸ”§ ì •ë‹µ
```bash
#!/bin/bash

V_NETLOG="network.log"
# "network.log" ì—ì„œ ëª‡ ì¤„ì¸ì§€ ì¶œë ¥
TOTAL_LINE=$(wc -l < "$V_NETLOG")
# success ì¤„ ì¶œë ¥
TOTAL_SUC=$(cut -d" " -f 5 < "$V_NETLOG" | grep "success" | wc -l)
# failed ì¤„ ì¶œë ¥
TOTAL_FAIL=$(cut -d" " -f 5 < "$V_NETLOG" | grep "failed" | wc -l)
# "$(())" ë¥¼ ì´ìš©í•˜ì—¬ ì‚°ìˆ˜ê°€ ë˜ê²Œ ë³€ê²½ í›„ ì„±ê³µë¥  ì¶œë ¥
TOTAL_AVG=$(($TOTAL_SUC * 100 / $TOTAL_LINE))

echo "=== ë„¤íŠ¸ì›Œí¬ ì—°ê²° ë¶„ì„ ê²°ê³¼ ==="
echo "ì „ì²´ ì—°ê²° ì‹œë„: $TOTAL_LINEê±´"
echo "ì„±ê³µ: $TOTAL_SUCê±´"
echo "ì‹¤íŒ¨: $TOTAL_FAILê±´"
echo "ì„±ê³µë¥ : $TOTAL_AVG%"
```
### ðŸ”§ ê²°ê³¼
```bash
[parksejin@localhost quests]$ source searchlog.sh
=== ë„¤íŠ¸ì›Œí¬ ì—°ê²° ë¶„ì„ ê²°ê³¼ ===
ì „ì²´ ì—°ê²° ì‹œë„: 8ê±´
ì„±ê³µ: 6ê±´
ì‹¤íŒ¨: 2ê±´
ì„±ê³µë¥ : 75%
```
## ðŸ“ ë¬¸ì œ 2. IP ì£¼ì†Œë³„ ì ‘ì† ë¹ˆë„ ìƒìœ„ ë¦¬ìŠ¤íŠ¸
### âœ… ìš”êµ¬ì‚¬í•­
- network.logì—ì„œ IP ì£¼ì†Œë³„ ì ‘ì† íšŸìˆ˜ë¥¼ ê³„ì‚°
- ì ‘ì† íšŸìˆ˜ ê¸°ì¤€ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬í•˜ì—¬ ìƒìœ„ 3ê°œë§Œ ì¶œë ¥
- ê° IPì˜ ì²« ì ‘ì† ì‹œê°„ë„ í•¨ê»˜ í‘œì‹œ
### ðŸŽ¯ ì¶œë ¥ í˜•íƒœ
```
=== ì ‘ì† ë¹ˆë„ TOP 3 ===
1ìœ„: 192.168.1.XXX (XíšŒ) - ì²« ì ‘ì†: 10:XX:XX
2ìœ„: 192.168.1.XXX (XíšŒ) - ì²« ì ‘ì†: 10:XX:XX  
3ìœ„: 192.168.1.XXX (XíšŒ) - ì²« ì ‘ì†: 10:XX:XX
```
### âœ… ì œí•œì‚¬í•­
- ifë¬¸ê³¼ ë³€ìˆ˜ë§Œ ì‚¬ìš©
- cut, sort, uniq, grep ëª…ë ¹ì–´ í™œìš©
- headë‚˜ tailë¡œ ê²°ê³¼ ì œí•œ

### ðŸ”§ ì •ë‹µ
```bash
#!/bin/bash

FILE="$1"

echo "=== ì ‘ì† ë¹ˆë„ TOP 3 ==="
# ë°›ì€ íŒŒì¼ì„ ê³µë°± ê¸°ì¤€ 3ë²ˆì§¸ í•„ë“œ ì¶”ì¶œ í›„ "uniq -c" ë¡œ ì •ë ¬ í›„ ìƒìœ„ 3ê°œì˜ ê²°ê³¼ ì¶œë ¥
TOP_IPS=$(cut -d" " -f3 "$FILE" | sort | uniq -c | sort -nr | head -n 3)
# ìˆœìœ„ë¥¼ ë§¤ê¸°ê¸° ìœ„í•œ ì´ˆê¸° ê°’
RANK=1
# While ë¬¸ì€ ê³µë°±ì„ êµ¬ë¶„ìžë¡œ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— "2 192.168.0.102" ë¥¼ "COUNT=2" ì™€ "IP=192.168.0.102" ë³€ìˆ˜ë¡œ ì§€ì •
while read COUNT IP
do
    COUNT=$(echo "$COUNT" | tr -d " ")
    FIRST_TIME=$(grep "$IP" "$FILE" | head -1 | cut -d" " -f2)
    echo "${RANK}ìœ„: $IP (${COUNT}íšŒ) - ì²« ì ‘ì†: $FIRST_TIME"
    RANK=$((RANK + 1))
    # <<< "$TOP_IPS" ë¥¼ ì´ìš©í•˜ëŠ” ì´ìœ ëŠ” ì˜ˆì‹œë¡œ "$TOP_IPS" ì•ˆì— "2 192.168.1.102" ì´ ìžˆìœ¼ë©´ íŒŒì¼ì´ ì•„ë‹Œ ë¬¸ìžì—´ë¡œ ë˜ì–´ìžˆê¸° ë•Œë¬¸ì— "<<< $TOP_IPS" ì‚¬ìš©
    # ë§Œì•½ íŒŒì¼ì„ ì½ì–´ì˜¤ëŠ” ê±°ë©´ "< filename.txt" ì‚¬ìš©
done <<< "$TOP_IPS"
```
### ðŸ”§ ê²°ê³¼
```bash
[parksejin@localhost quests]$ source connectlog.sh network.log
=== ì ‘ì† ë¹ˆë„ TOP 3 ===
1ìœ„: 192.168.1.102 (2íšŒ) - ì²« ì ‘ì†: 10:31:15
2ìœ„: 192.168.1.101 (2íšŒ) - ì²« ì ‘ì†: 10:30:30
3ìœ„: 192.168.1.100 (2íšŒ) - ì²« ì ‘ì†: 10:30:25
```

## ðŸ“ ë¬¸ì œ 3. ì„œë²„ ìƒíƒœ ì ê²€ ìŠ¤í¬ë¦½íŠ¸
### âœ… ìš”êµ¬ì‚¬í•­
- servers.sh ì‹¤í–‰í•´ ê° ì„œë²„ì— ëŒ€í•´ ping í…ŒìŠ¤íŠ¸ ì‹¤í–‰
- ì‘ë‹µ ìžˆëŠ” ì„œë²„ì™€ ì—†ëŠ” ì„œë²„ë¥¼ êµ¬ë¶„í•˜ì—¬ ì¶œë ¥
- ì‘ë‹µ ì‹œê°„ì´ 100ms ì´ìƒì¸ ì„œë²„ëŠ” "ëŠë¦¼" í‘œì‹œ

### ðŸŽ¯ ìž…ë ¥ í˜•íƒœ
```
	~$ servers.sh 123.92.0.12
```
### ðŸŽ¯ ì¶œë ¥ í˜•íƒœ
```
=== ì„œë²„ ìƒíƒœ ì ê²€ ê²°ê³¼ ===
[ì •ìƒ] web01 (123.92.0.12) - ì‘ë‹µì‹œê°„: XXms
OR
=== ì„œë²„ ìƒíƒœ ì ê²€ ê²°ê³¼ ===
[ì˜¤í”„ë¼ì¸] db01 (123.92.0.11) - ì‘ë‹µì—†ìŒ
...
```

### âœ… ì œí•œì‚¬í•­
- ifë¬¸ê³¼ ë³€ìˆ˜ë§Œ ì‚¬ìš©
- cut, ping ëª…ë ¹ì–´ í™œìš©
- pingì€ 1íšŒë§Œ ì‹¤í–‰ (ping -c 1)

### ðŸ”§ ì •ë‹µ
```bash
#!/bin/bash

V_PING="$1"
# í•‘ì„ í•œ ë²ˆ ì¶œë ¥
V_PING_CHECK=$(ping -c 1 "$V_PING")
# ì¶œë ¥í•œ í•‘ì—ì„œ "time=" ì„ ì´ìš©í•˜ì—¬ ì‹œê°„ ì¶œë ¥
V_PING_TIME=$(echo "$V_PING_CHECK" | grep "time=" | cut -d" " -f 7)

echo "=== ì„œë²„ ìƒíƒœ ì ê²€ ê²°ê³¼ ==="
# ì¶œë ¥í•œ í•‘ì—ì„œ "1 received" ë¥¼ ì°¾ì€ í›„ ìžˆìœ¼ë©´ ì •ìƒ ì¶œë ¥
# ì—†ìœ¼ë©´ ì˜¤í”„ë¼ì¸ ì¶œë ¥
if echo "$V_PING_CHECK" | grep -q "1 received"; then
        echo "[ì •ìƒ] ($V_PING) - ì‘ë‹µì‹œê°„ : "$V_PING_TIME"ms"
else
        echo "[ì˜¤í”„ë¼ì¸] ($V_PING) - ì‘ë‹µì—†ìŒ"
fi
```
### ðŸ”§ ê²°ê³¼
```bash
[mk@192.168.0.100 ~/parksejin]$ source servers.sh 192.168.0.4
=== ì„œë²„ ìƒíƒœ ì ê²€ ê²°ê³¼ ===
[ì •ìƒ] (192.168.0.4) - ì‘ë‹µì‹œê°„ : time=1.11ms

[mk@192.168.0.100 ~/parksejin]$ source servers.sh 192.168.0.0
=== ì„œë²„ ìƒíƒœ ì ê²€ ê²°ê³¼ ===
[ì˜¤í”„ë¼ì¸] (192.168.0.0) - ì‘ë‹µì—†ìŒ
```
## ðŸ“ ë¬¸ì œ 4. ë„¤íŠ¸ì›Œí¬ íŠ¸ëž˜í”½ ìž„ê³„ê°’ ëª¨ë‹ˆí„°ë§
### âœ… ìš”êµ¬ì‚¬í•­
- connections.txtì—ì„œ ì ‘ì† ìˆ˜ê°€ 10 ì´ìƒì¸ IPë¥¼ "ë†’ìŒ", 5-9ëŠ” "ë³´í†µ", 4 ì´í•˜ëŠ” "ë‚®ìŒ"ìœ¼ë¡œ ë¶„ë¥˜
- ê° ë¶„ë¥˜ë³„ë¡œ ê°œìˆ˜ ê³„ì‚°í•˜ì—¬ ì¶œë ¥
- "ë†’ìŒ" ë¶„ë¥˜ì˜ IPë“¤ë§Œ ë³„ë„ë¡œ ë‚˜ì—´
### ðŸŽ¯ ì¶œë ¥ í˜•íƒœ
```
=== íŠ¸ëž˜í”½ ë¶„ì„ ê²°ê³¼ ===
ë†’ìŒ(10íšŒ ì´ìƒ): Xê°œ
ë³´í†µ(5-9íšŒ): Yê°œ  
ë‚®ìŒ(4íšŒ ì´í•˜): Zê°œ

[ì£¼ì˜ í•„ìš” IP ëª©ë¡]
192.168.1.XXX (XXíšŒ)
192.168.1.XXX (XXíšŒ)
```
### âœ… ì œí•œì‚¬í•­
- ifë¬¸ê³¼ ë³€ìˆ˜ë§Œ ì‚¬ìš©
- cut, sort ëª…ë ¹ì–´ í™œìš©
- ìˆ«ìž ë¹„êµë¥¼ ìœ„í•œ ì¡°ê±´ë¬¸ ì‚¬ìš©
### ðŸ”§ ì •ë‹µ
```bash
#!/bin/bash

V_CHECK="$1"
# HIGH, MEDIUM, LOWë¥¼ 0ìœ¼ë¡œ ë³€ìˆ˜ ì§€ì •
HIGH=0
MEDIUM=0
LOW=0
# ë³€ìˆ˜ "HIGH" ì— í•´ë‹¹í•˜ëŠ” IP ë¦¬ìŠ¤íŠ¸ë¥¼ ì €ìž¥í•  ë¹ˆ ë¬¸ìžì—´ë¡œ ì´ˆê¸°í™”
HIGH_IP=""
# "while read" ë¥¼ ì´ìš©í•˜ì—¬ ê³µë°±ì„ ê¸°ì¤€ìœ¼ë¡œ êµ¬ë¶„í•˜ì—¬ ì˜ˆì‹œë¡œ "192.168.1.102 12" ë¥¼ "V_IP=192.168.1.101", "V_LINE=12" ë¡œ ìžë™ìœ¼ë¡œ ë‚˜ëˆ  ì €ìž¥
while read V_IP V_LINE
do
        if [ "$V_LINE" -ge 10 ]; then
                HIGH=$((HIGH + 1))
                # ê¸°ì¡´ì— ì €ìž¥ëœ ë¬¸ìžì—´ "HIGH_IP" ë‚´ìš© ë’¤ì— ë£¨í”„ë¥¼ ëŒë ¤ì„œ ìƒˆë¡œ ë°œê²¬ëœ IP ì£¼ì¡°ì™€ ì ‘ì† íšŸìˆ˜ë¥¼ append í•´ì„œ ëˆ„ì ì‹œí‚´
                # "${HIGH_UP}" ê°€ ì—†ìœ¼ë©´ ë§¤ë²ˆ ìƒˆë¡œ í• ë‹¹í•˜ê¸° ë•Œë¬¸ì— ì´ì „ ì €ìž¥í•œ ê°’ì´ ì‚¬ë¼ì ¸ ë§ˆì§€ë§‰ IP ì •ë³´ë§Œ ë‚¨ê²Œ ë˜ì–´ í•œ ì¤„ë§Œ ì¶œë ¥ë¨
                HIGH_IP="${HIGH_IP}${V_IP} (${V_LINE}íšŒ)\n"
        elif [ "$V_LINE" -ge 5 ]; then
                MEDIUM=$((MEDIUM + 1))
        else
                LOW=$((LOW + 1))
        fi
done < "$V_CHECK"

echo -e "=== íŠ¸ëž˜í”½ ë¶„ì„ ê²°ê³¼ ===
ë†’ìŒ(10íšŒ ì´ìƒ) : $HIGHê°œ
ë³´í†µ(5-9íšŒ) : $MEDIUMê°œ
ë‚®ìŒ(4íšŒ ì´í•˜) : $LOWê°œ

[ì£¼ì˜ í•„ìš” IP ëª©ë¡]
$HIGH_IP"
```
### ðŸ”§ ê²°ê³¼
```bash
[parksejin@localhost quests]$ source checkconnections.sh connections.txt
=== íŠ¸ëž˜í”½ ë¶„ì„ ê²°ê³¼ ===
ë†’ìŒ(10íšŒ ì´ìƒ): 2ê°œ
ë³´í†µ(5-9íšŒ): 3ê°œ
ë‚®ìŒ(4íšŒ ì´í•˜): 1ê°œ

[ì£¼ì˜ í•„ìš” IP ëª©ë¡]
192.168.1.101 (12íšŒ)
192.168.1.104 (15íšŒ)
```